<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lease Captain | Your Kenyan Lease Haven</title>
    <!-- Google Font: Source Sans Pro -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="/plugins/fontawesome-free/css/all.min.css">
    <!-- overlayScrollbars -->
    <link rel="stylesheet" href="/plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="/dist/css/adminlte.min2167.css?v=3.2.0">
    <!-- Custom Styles -->
    <link rel="stylesheet" href="/css/lease.css">
    <link rel="icon" type="image/png" sizes="56x56" href="/assets/images/1.png">

    <style>
        /* Enhanced Styling for Kenyan Lease Portal */
        .lease-hero {
            background: linear-gradient(135deg, #003366 0%, #28a745 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 25px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .lease-card {
            border-radius: 10px;
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.15);
            background: #fff;
            overflow: hidden;
            transition: transform 0.3s;
        }

        .lease-card:hover {
            transform: translateY(-5px);
        }

        .lease-card .card-header {
            background: #003366;
            color: white;
            padding: 15px;
            font-size: 1.5rem;
            font-weight: bold;
            border-bottom: 2px solid #28a745;
        }

        .lease-card .card-body {
            padding: 25px;
            background: linear-gradient(to bottom, #f8f9fa, #ffffff);
        }

        .lead {
            font-size: 1.15rem;
            line-height: 1.6;
            color: #333;
        }

        .text-secondary {
            color: #6c757d;
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.9rem;
        }

        .btn-primary {
            background-color: #003366;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            transition: all 0.3s;
        }

        .btn-primary:hover {
            background-color: #00509e;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .btn-success {
            background-color: #28a745;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
        }

        .btn-success:hover {
            background-color: #218838;
        }

        .btn-warning {
            background-color: #ffc107;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
        }

        .btn-warning:hover {
            background-color: #e0a800;
        }

        .btn-info {
            background-color: #17a2b8;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
        }

        .btn-info:hover {
            background-color: #138496;
        }

        .virtual-tour-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .compliance-note {
            background: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            color: #856404;
        }

        /* Responsive Design */
        @media (max-width: 576px) {
            .lease-hero h1 {
                font-size: 1.75rem;
            }
            .lead {
                font-size: 1rem;
            }
            .btn {
                font-size: 0.9rem;
                padding: 8px 15px;
            }
        }

        @media (max-width: 768px) {
            .lease-card .card-body {
                padding: 20px;
            }
        }
    </style>
</head>
<body class="hold-transition dark-mode sidebar-mini layout-fixed layout-navbar-fixed layout-footer-fixed">
    <div class="wrapper">
        <!-- Preloader -->
        <div class="preloader flex-column justify-content-center align-items-center">
            <img class="animation__wobble" src="/assets/images/2.png" alt="LeaseCaptainLogo" height="150" width="150">
        </div>

        <!-- Navbar -->
        <nav class="main-header navbar navbar-expand navbar-light">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
                </li>
            </ul>
            <ul class="navbar-nav ml-auto">
                <li class="nav-item dropdown">
                    <a class="nav-link" data-toggle="dropdown" href="#">
                        <i class="far fa-user"></i>
                        <% if (tenant) { %>
                            Welcome, <%= tenant.name %>
                        <% } else { %>
                            Welcome, Guest
                        <% } %>
                    </a>
                    <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
                        <a href="/tenantPortal/logout" class="dropdown-item">
                            <i class="fas fa-sign-out-alt mr-2"></i> Logout
                        </a>
                    </div>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-widget="fullscreen" href="#" role="button">
                        <i class="fas fa-expand-arrows-alt"></i>
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Main Sidebar Container -->
        <aside class="main-sidebar sidebar-light-primary elevation-4">
            <a href="/tenantPortal/dashboard" class="brand-link">
                <img src="/assets/images/2.png" alt="LeaseCaptain Logo" class="brand-image img-circle elevation-3" style="opacity: .8">
                <h4 class="brand-text font-weight-bold"><strong>Tenant Portal</strong></h4>
            </a>
            <div class="sidebar">
                <div class="user-panel mt-3 pb-3 mb-3 d-flex">
                    <div class="image">
                        <img src="/dist/img/cap.png" class="img-circle elevation-2" alt="User Image">
                    </div>
                    <div class="info">
                        <a href="#" class="d-block">
                            <strong>
                                <% if (tenant) { %>
                                    <%= tenant.name %>
                                <% } else { %>
                                    Guest
                                <% } %>
                            </strong>
                        </a>
                    </div>
                </div>
                <nav class="mt-2">
                    <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
                        <li class="nav-item"><a href="/tenantPortal/dashboard" class="nav-link active" style="background-color: #003366; color: #ffffff;"><i class="nav-icon fas fa-tachometer-alt"></i><p>Dashboard</p></a></li>
                        <li class="nav-item"><a href="/payments" class="nav-link"><i class="nav-icon fas fa-money-bill-wave"></i><p>Payments</p></a></li>
                        <li class="nav-item"><a href="/requestMaintenance" class="nav-link"><i class="nav-icon fas fa-wrench"></i><p>Maintenance</p></a></li>
                        <li class="nav-item"><a href="/lease" class="nav-link"><i class="nav-icon fas fa-file-contract"></i><p>Lease</p></a></li>
                        <li class="nav-item"><a href="/tenant/agreement" class="nav-link"><i class="nav-icon fas fa-hourglass-half"></i><p>Agreement</p></a></li>
                        <li class="nav-item"><a href="/tenant/profile" class="nav-link"><i class="nav-icon fas fa-user"></i><p>Profile</p></a></li>
                    </ul>
                </nav>
            </div>
        </aside>

        <!-- Content Wrapper -->
        <div class="content-wrapper">
           
                <% if (tenant) { %>
                    <div class="card mb-4 shadow-sm lease-card">
                        <div class="card-header">
                            <h5 class="mb-0">Lease Details for <%= tenant.name %></h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <h6 class="text-secondary">Property Address:</h6>
                                    <p class="lead"><%= tenant.property.address %></p>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <h6 class="text-secondary">Unit Type:</h6>
                                    <p class="lead"><%= tenant.unit.unitType || 'Modern Apartment' %></p>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <h6 class="text-secondary">Lease Start Date:</h6>
                                    <p class="lead"><%= new Date(tenant.leaseStartDate).toLocaleDateString() %></p>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <h6 class="text-secondary">Lease End Date:</h6>
                                    <p class="lead"><%= new Date(tenant.leaseEndDate).toLocaleDateString() %></p>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <h6 class="text-secondary">Monthly Rent:</h6>
                                    <p class="lead">Ksh. <%= tenant.rentPaid.toFixed(2) %></p>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <h6 class="text-secondary">Security Deposit:</h6>
                                    <p class="lead">Ksh. <%= tenant.deposit.toFixed(2) %></p>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <div class="card shadow-sm h-100">
                                        <div class="card-body text-center">
                                            <h6 class="text-secondary mb-3">
                                                <i class="fas fa-file-contract mr-2"></i> Lease Status
                                            </h6>
                                            <div class="d-flex justify-content-center align-items-center mb-3">
                                                <span class="lease-icon <%= leaseStatus === 'Active' ? 'text-success' : 'text-warning' %>">
                                                    <i class="fas <%= leaseStatus === 'Active' ? 'fa-check-circle' : 'fa-exclamation-triangle' %> fa-2x"></i>
                                                </span>
                                                <p class="lead ml-3 mb-0 <%= leaseStatus === 'Active' ? 'text-success' : 'text-warning' %>">
                                                    <%= leaseStatus || 'Active' %>
                                                </p>
                                            </div>
                                            
                                        </div>
                                    </div>
                                </div>
                                
                               
                                <div class="col-md-6 mb-3">
                                    <h6 class="text-secondary">Green Features:</h6>
                                    <p class="lead"><%= tenant.property.greenFeatures || 'Solar Panels, Rainwater Harvesting' %></p>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <h6 class="text-secondary">Penalty for Late Payment:</h6>
                                    <p class="lead">Ksh. <%= tenant.latePenalty || '500.00' %> (per week)</p>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <h6 class="text-secondary">Landlord Contact:</h6>
                                    <p class="lead"><%= tenant.owner.phone?.name || 'John Doe' %> - <%= tenant.landlord?.phone || '+254 700 123 456' %></p>
                                </div>
                            </div>
                            <div class="mb-3">
                                <h6 class="text-secondary">Tenant Contact:</h6>
                                <p class="lead"><strong>Email:</strong> <%= tenant.email || 'Not provided' %></p>
                                <p class="lead"><strong>Phone:</strong> <%= tenant.phone || 'Not provided' %></p>
                            </div>
                            <div class="mb-3">
                                <h6 class="text-secondary">Smart Home Features:</h6>
                                <p class="lead"><%= tenant.unit.smartFeatures || 'Wi-Fi Enabled, Smart Locks' %></p>
                            </div>
                            <div class="mb-3">
                                <h6 class="text-secondary">Additional Notes:</h6>
                                <p class="lead"><%= tenant.notes || 'Enjoy your eco-friendly urban retreat!' %></p>
                            </div>
                            <div class="compliance-note">
                                <strong>Compliance Note:</strong> This lease adheres to the Kenyan Landlord and Tenant Act. Rent increases require 2 months' notice, and termination requires 1 month's notice unless otherwise stated.
                            </div>
                        </div>
                    </div>

                    <!-- Virtual Tour Section -->
                    <div class="card mb-4 shadow-sm virtual-tour-card">
                        <div class="card-header">
                            <h5 class="mb-0">Take a Virtual Tour</h5>
                        </div>
                        <div class="card-body text-center">
                            <button class="btn btn-primary" data-toggle="modal" data-target="#virtualTourModal">
                                <i class="fas fa-vr-cardboard"></i> Explore Your Space
                            </button>
                            <div class="modal fade" id="virtualTourModal" tabindex="-1" role="dialog">
                                <div class="modal-dialog modal-lg" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Your Property in 360°</h5>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">×</span>
                                            </button>
                                        </div>
                                        <div class="modal-body">
                                            <iframe src="/virtual-tour/<%= tenant.property._id %>" width="100%" height="400" frameborder="0" allowfullscreen></iframe>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="d-flex justify-content-between flex-wrap">
                        <button class="btn btn-primary mb-2" onclick="window.print();">
                            <i class="fas fa-print"></i> Print Lease
                        </button>
                        <a href="/lease/download" class="btn btn-success mb-2">
                            <i class="fas fa-download"></i> Download PDF
                        </a>
                        <button class="btn btn-info mb-2" data-toggle="modal" data-target="#renewLeaseModal">
                            <i class="fas fa-sync-alt"></i> Renew Lease
                        </button>
                        <button class="btn btn-warning mb-2" data-toggle="modal" data-target="#terminateLeaseModal">
                            <i class="fas fa-times-circle"></i> Request Termination
                        </button>
                    </div>

                    <!-- Renew Lease Modal -->
                    <div class="modal fade" id="renewLeaseModal" tabindex="-1" role="dialog">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">Renew Your Lease</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">×</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form action="/lease/renew" method="POST">
                                        <input type="hidden" name="tenantId" value="<%= tenant._id %>">
                                        <div class="form-group">
                                            <label for="newEndDate">New End Date</label>
                                            <input type="date" class="form-control" id="newEndDate" name="newEndDate" required>
                                        </div>
                                        <button type="submit" class="btn btn-primary">Submit Renewal</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Terminate Lease Modal -->
                    <div class="modal fade" id="terminateLeaseModal" tabindex="-1" role="dialog">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">Request Lease Termination</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">×</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form action="/lease/terminate" method="POST">
                                        <input type="hidden" name="tenantId" value="<%= tenant._id %>">
                                        <div class="form-group">
                                            <label for="terminationDate">Requested Termination Date</label>
                                            <input type="date" class="form-control" id="terminationDate" name="terminationDate" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="reason">Reason for Termination</label>
                                            <textarea class="form-control" id="reason" name="reason" rows="3" required></textarea>
                                        </div>
                                        <button type="submit" class="btn btn-warning">Submit Request</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                <% } else { %>
                    <div class="alert alert-danger text-center">
                        <strong>Oops!</strong> No tenant or lease info found. Contact support to get started!
                    </div>
                <% } %>
            </main>
        </div>

        <!-- Main Footer -->
        <footer class="main-footer">
            <strong>Copyright © 2024-2025 <a href="https://leasecaptain.com/">Lease Captain</a></strong>
            All rights reserved.
            <div class="float-right d-none d-sm-inline-block">
                <b>Version</b> 1.0.2
            </div>
        </footer>
    </div>

    <!-- Scripts -->
    <script src="/plugins/jquery/jquery.min.js"></script>
    <script src="/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>
    <script src="/dist/js/adminlte2167.js?v=3.2.0"></script>
    <script src="/plugins/jquery-mousewheel/jquery.mousewheel.js"></script>
    <script src="/plugins/raphael/raphael.min.js"></script>
    <script src="/plugins/jquery-mapael/jquery.mapael.min.js"></script>
    <script src="/plugins/jquery-mapael/maps/usa_states.min.js"></script>
    <script src="/plugins/chart.js/Chart.min.js"></script>
    <script src="/dist/js/demo.js"></script>
    <script src="/dist/js/pages/dashboard2.js"></script>
    <script src="/js/lease.js"></script>
</body>
</html>