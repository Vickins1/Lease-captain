<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Lease Captain | Dashboard</title>

    <!-- Google Font: Source Sans Pro -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&amp;display=fallback">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="/plugins/fontawesome-free/css/all.min.css">
    <!-- overlayScrollbars -->
    <link rel="stylesheet" href="/plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="/dist/css/adminlte.min2167.css?v=3.2.0">
    <link rel="icon" type="image/png" sizes="56x56" href="/assets/images/1.png">
</head>

<body class="hold-transition dark-mode sidebar-mini layout-fixed layout-navbar-fixed layout-footer-fixed">
    <div class="wrapper">

        <!-- Preloader -->
        <div class="preloader flex-column justify-content-center align-items-center">
            <img class="animation__wobble" src="/assets/images/2.png" alt="AdminLTELogo" height="150" width="150">
        </div>

        <!-- Navbar -->
        <nav class="main-header navbar navbar-expand navbar-light">
            <!-- Left navbar links -->
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
                </li>
            </ul>

            <!-- Right navbar links -->
            <ul class="navbar-nav ml-auto">
                <!-- Navbar Search -->
                <li class="nav-item">
                    <a class="nav-link" data-widget="navbar-search" href="#" role="button">
                        <i class="fas fa-search"></i>
                    </a>
                    <div class="navbar-search-block">
                        <form class="form-inline">
                            <div class="input-group input-group-sm">
                                <input class="form-control form-control-navbar" type="search" placeholder="Search"
                                    aria-label="Search">
                                <div class="input-group-append">
                                    <button class="btn btn-navbar" type="submit">
                                        <i class="fas fa-search"></i>
                                    </button>
                                    <button class="btn btn-navbar" type="button" data-widget="navbar-search">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </li>

           
                <!-- Notifications Dropdown Menu -->
                <li class="nav-item dropdown">
                    <a class="nav-link" data-toggle="dropdown" href="#">
                        <i class="far fa-bell"></i>
                    </a>

                </li>
                <li class="nav-item">
                    <a class="nav-link" data-widget="fullscreen" href="#" role="button">
                        <i class="fas fa-expand-arrows-alt"></i>
                    </a>
                </li>
                <li class="nav-item ">
                    <a href="/logout" class="nav-link" role="button">
                        <i class="nav-icon fas fa-sign-out-alt"></i>
                    </a>
                </li>

            </ul>
        </nav>
        <!-- /.navbar -->

        <!-- Main Sidebar Container -->
        <aside class="main-sidebar sidebar-light-primary elevation-4">
            <!-- Brand Logo -->
            <a href="/" class="brand-link">
                <img src="/assets/images/2.png" alt="AdminLTE Logo" class="brand-image img-circle elevation-3"
                    style="opacity: .8">
                <h4 class="brand-text font-weight-bold"><strong>Lease Captain</strong></h4>
            </a>

            <!-- Sidebar -->
            <div class="sidebar">
                <!-- Sidebar user panel (optional) -->
                <div class="user-panel mt-3 pb-3 mb-3 d-flex">
                    <div class="image">
                        <img src="/dist/img/user2-160x160.jpg" class="img-circle elevation-2" alt="User Image">
                    </div>
                    <div class="info">
                        <a href="#" class="d-block" aria-haspopup="true" aria-expanded="false">
                            <span>Welcome,</span>
                            <strong>
                                <%= currentUser.username %>
                            </strong>
                        </a>
                    </div>
                </div>

               
                <!-- Sidebar Menu -->
<nav class="mt-2">
    <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
        <!-- Dashboard -->
        <li class="nav-item">
            <a href="/dashboard" class="nav-link active" style="background-color: #003366; color: #ffffff;">
                <i class="nav-icon fas fa-tachometer-alt"></i>
                <p>Dashboard</p>
            </a>
        </li>

        <!-- Property Management -->
        <li class="nav-header"><strong>PROPERTY MANAGEMENT</strong></li>
        <li class="nav-item">
            <a href="/tenancy-manager/properties" class="nav-link">
                <i class="nav-icon fas fa-building"></i>
                <p>Properties</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="/tenancy-manager/property/units" class="nav-link">
                <i class="nav-icon fas fa-cogs"></i>
                <p>Property Units</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="/tenancy-manager/propertyListing" class="nav-link">
                <i class="nav-icon fas fa-list-alt"></i>
                <p>List Properties</p>
            </a>
        </li>

        <li class="nav-item">
            <a href="#" class="nav-link">
                <i class="nav-icon fas fa-chart-line"></i>
                <p>
                    Tenant Management
                    <i class="right fas fa-angle-left"></i>
                </p>
            </a>
            <ul class="nav nav-treeview">
                <li class="nav-item">
                    <a href="/tenancy-manager/tenants" class="nav-link">
                        <i class="far fa-circle nav-icon"></i>
                        <p>Tenants</p>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/maintenance-requests" class="nav-link">
                        <i class="far fa-circle nav-icon"></i>
                        <p>Maintenance Requests</p>
                    </a>
                </li>
            </ul>
        </li>

        <!-- Land Management -->
        <li class="nav-header"><strong>LAND MANAGEMENT</strong></li>
        <li class="nav-item">
            <a href="/tenancy-manager/lands" class="nav-link">
                <i class="nav-icon fas fa-map"></i>
                <p>Registered Lands</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="/tenancy-manager/land-parcels" class="nav-link">
                <i class="nav-icon fas fa-th-large"></i>
                <p>Land Parcels</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="/tenancy-manager/land-reports" class="nav-link">
                <i class="nav-icon fas fa-chart-area"></i>
                <p>Land Reports</p>
            </a>
        </li>

        <!-- Lease Management -->
        <li class="nav-header"><strong>LEASE MANAGEMENT</strong></li>
        <li class="nav-item">
            <a href="/tenancy-manager/leases" class="nav-link">
                <i class="nav-icon fas fa-file-contract"></i>
                <p>Leases</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="/tenancy-manager/lease-templates" class="nav-link">
                <i class="nav-icon fas fa-file-alt"></i>
                <p>Lease Templates</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="/tenancy-manager/lease-reports" class="nav-link">
                <i class="nav-icon fas fa-chart-bar"></i>
                <p>Lease Reports</p>
            </a>
        </li>

        <!-- Vehicle Management -->
        <li class="nav-header"><strong>VEHICLE MANAGEMENT</strong></li>
        <li class="nav-item">
            <a href="/tenancy-manager/vehicles" class="nav-link">
                <i class="nav-icon fas fa-car"></i>
                <p>Registered Vehicles</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="/tenancy-manager/vehicle-parking" class="nav-link">
                <i class="nav-icon fas fa-parking"></i>
                <p>Parking Spaces</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="/tenancy-manager/vehicle-reports" class="nav-link">
                <i class="nav-icon fas fa-clipboard-list"></i>
                <p>Vehicle Reports</p>
            </a>
        </li>

        <!-- Finance -->
        <li class="nav-header"><strong>FINANCE MANAGEMENT</strong></li>
        <li class="nav-item">
            <a href="/tenancy-manager/payments" class="nav-link">
                <i class="nav-icon fas fa-money-bill-wave"></i>
                <p>Payment Transactions</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="/reports-invoices" class="nav-link">
                <i class="nav-icon fas fa-file-invoice"></i>
                <p>Reports & Invoices</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="/expenses" class="nav-link">
                <i class="nav-icon fas fa-wallet"></i>
                <p>Expense Tracking</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="/budget-planning" class="nav-link">
                <i class="nav-icon fas fa-chart-pie"></i>
                <p>Budget Planning</p>
            </a>
        </li>

        <!-- Notifications -->
        <li class="nav-header"><strong>NOTIFICATION MANAGEMENT</strong></li>
        <li class="nav-item">
            <a href="/sms&email" class="nav-link">
                <i class="nav-icon fas fa-sms"></i>
                <p>SMS & Email</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="/sms&email" class="nav-link">
                <i class="nav-icon fas fa-credit-card"></i>
                <p>Credit Top-up</p>
            </a>
        </li>

        <!-- Staff Management -->
        <li class="nav-header"><strong>STAFF MANAGEMENT</strong></li>
        <li class="nav-item">
            <a href="/staff-directory" class="nav-link">
                <i class="nav-icon fas fa-user-tie"></i>
                <p>Staff Directory</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="/staff-attendance" class="nav-link">
                <i class="nav-icon fas fa-calendar-check"></i>
                <p>Attendance</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="/staff-payroll" class="nav-link">
                <i class="nav-icon fas fa-file-invoice-dollar"></i>
                <p>Payroll</p>
            </a>
        </li>

        <!-- Account Management -->
        <li class="nav-header"><strong>ACCOUNT MANAGEMENT</strong></li>
        <li class="nav-item">
            <a href="/tenancy-manager/profile" class="nav-link">
                <i class="nav-icon fas fa-user"></i>
                <p>Profile Settings</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="/tenancy-manager/security" class="nav-link">
                <i class="nav-icon fas fa-lock"></i>
                <p>Security Settings</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="/connect" class="nav-link">
                <i class="nav-icon fas fa-link"></i>
                <p>Payment Gateway</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="/users" class="nav-link">
                <i class="nav-icon fas fa-users"></i>
                <p>User Accounts</p>
            </a>
        </li>
        <li class="nav-item">
            <a href="/upgrade-subscription" class="nav-link">
                <i class="nav-icon fas fa-arrow-circle-up"></i>
                <p>Upgrade Subscription</p>
            </a>
        </li>
        <!-- Support -->
        <li class="nav-item mt-auto">
            <a href="/contacts" class="nav-link d-flex align-items-center justify-content-center"
                style="background-color: #003366; color: #ffffff; border-radius: 5px; margin: 10px;">
                <i class="fas fa-headset mr-2"></i>
                <p>Support</p>
            </a>
        </li>
    </ul>
</nav>

            </div>

            <!-- /.sidebar -->

        </aside>

        <div class="content-wrapper">
            <!-- Content Header (Page header) -->
            <div class="content-header">
                <div class="container-fluid">
                    <header class="header">
                        <h1 class="header-title">Notifications Dashboard</h1>
                        <p class="header-subtitle">Manage tenant communications with ease</p>
                    </header>
                </div><!-- /.container-fluid -->
            </div>
        
            <!-- Main content -->
            <section class="content">
                <div class="container-fluid">
                    <!-- Messages Section -->
                    <section class="messages-section">
                        <% if (error && error.length > 0) { %>
                            <div class="alert alert-error animate__animated animate__fadeIn">
                                <span class="alert-icon">⚠️</span>
                                <%= error %>
                            </div>
                        <% } %>
                        <% if (success && success.length > 0) { %>
                            <div class="alert alert-success animate__animated animate__fadeIn">
                                <span class="alert-icon">✅</span>
                                <%= success %>
                            </div>
                        <% } %>
                    </section>
        
                    <!-- Quick Actions -->
                    <section class="quick-actions">
                        <div class="card quick-action-card" onclick="showModal('reminderModal')">
                            <i class="fas fa-bell"></i>
                            <h3>Create Reminder</h3>
                            <p>Schedule new notifications</p>
                        </div>
                        <div class="card quick-action-card" id="resendTrigger">
                            <i class="fas fa-redo"></i>
                            <h3>Resend Reminders</h3>
                            <p>Resend to tenants</p>
                        </div>
                        <div class="card quick-action-card" id="messageTrigger">
                            <i class="fas fa-envelope"></i>
                            <h3>Send Message</h3>
                            <p>Broadcast to all</p>
                        </div>
                    </section>
        
                    <!-- Resend Reminders Form -->
                    <section class="form-section" id="resendSection" style="display: none;">
                        <div class="card form-card">
                            <h2>Resend Reminders</h2>
                            <form id="reminderForm" class="modern-form">
                                <div class="form-group">
                                    <label>Send Reminder To:</label>
                                    <select id="reminderOption" class="form-select" required>
                                        <option value="all">All Tenants</option>
                                        <option value="single">Specific Tenant</option>
                                    </select>
                                </div>
                                <div class="form-group" id="tenantDropdown" style="display: none;">
                                    <label>Select Tenant:</label>
                                    <select id="tenantId" class="form-select">
                                        <option value="" disabled selected>Loading tenants...</option>
                                    </select>
                                </div>
                                <button type="submit" class="btn btn-primary">Send Now</button>
                            </form>
                        </div>
                    </section>
        
                    <!-- Manual Message Form -->
                    <section class="form-section" id="messageSection" style="display: none;">
                        <div class="card form-card">
                            <h2>Broadcast Message</h2>
                            <form id="manualSendAllForm" class="modern-form">
                                <div class="form-group">
                                    <label>Message Type:</label>
                                    <select name="messageType" class="form-select" required>
                                        <option value="sms">SMS</option>
                                        <option value="email">Email</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Message Content:</label>
                                    <textarea name="message" rows="4" placeholder="Type your message here..." required class="form-textarea"></textarea>
                                </div>
                                <button type="submit" class="btn btn-primary">Send to All</button>
                            </form>
                        </div>
                    </section>
        
                    <!-- Reminder Modal -->
                    <div id="reminderModal" class="modal">
                        <div class="modal-content animate__animated animate__zoomIn">
                            <span class="modal-close" onclick="closeModal('reminderModal')">×</span>
                            <h2>Create New Reminder</h2>
                            <form action="/reminders/create" method="POST" class="modern-form">
                                <div class="form-group">
                                    <label>Title:</label>
                                    <input type="text" name="title" placeholder="Reminder title" required class="form-input">
                                </div>
                                <div class="form-group">
                                    <label>Message:</label>
                                    <textarea name="message" rows="3" placeholder="Your reminder message" required class="form-textarea"></textarea>
                                </div>
                                <div class="form-group">
                                    <label>Schedule:</label>
                                    <input type="datetime-local" name="sendAt" required class="form-input">
                                </div>
                                <div class="form-group">
                                    <label>Frequency:</label>
                                    <select name="frequency" class="form-select" required>
                                        <option value="" disabled selected>Choose frequency</option>
                                        <option value="once">One Time</option>
                                        <option value="daily">Daily</option>
                                        <option value="weekly">Weekly</option>
                                        <option value="monthly">Monthly</option>
                                    </select>
                                </div>
                                <button type="submit" class="btn btn-primary">Create Reminder</button>
                            </form>
                        </div>
                    </div>
                </div><!-- /.container-fluid -->
            </section><!-- /.content -->
        </div><!-- /.content-wrapper -->
        
        <style>
            :root {
                --primary: #003366;
                --secondary: #63b3ed;
                --success: #48bb78;
                --error: #f56565;
                --background: #f7fafc;
                --card-bg: #ffffff;
            }
        
            .content-wrapper {
                background-color: var(--background);
                padding-bottom: 20px;
            }
        
            .content-header {
                padding: 15px 0;
            }
        
            .header {
                text-align: center;
                padding: 20px;
                background: linear-gradient(135deg, var(--primary), var(--secondary));
                color: white;
                border-radius: 10px;
                margin-bottom: 20px;
            }
        
            .header-title {
                margin: 0;
                font-size: 2.5rem;
                font-weight: 700;
            }
        
            .header-subtitle {
                margin: 5px 0 0;
                font-size: 1.1rem;
                opacity: 0.9;
            }
        
            .alert {
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 20px;
                display: flex;
                align-items: center;
                gap: 10px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            }
        
            .alert-error { background: var(--error); color: white; }
            .alert-success { background: var(--success); color: white; }
            .alert-icon { font-size: 1.2rem; }
        
            .quick-actions {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 20px;
                margin-bottom: 30px;
            }
        
            .quick-action-card {
                background: var(--card-bg);
                padding: 20px;
                border-radius: 10px;
                text-align: center;
                cursor: pointer;
                transition: transform 0.2s, box-shadow 0.2s;
                box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            }
        
            .quick-action-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 6px 12px rgba(0,0,0,0.15);
            }
        
            .quick-action-card i {
                font-size: 2rem;
                color: var(--primary);
                margin-bottom: 10px;
            }
        
            .form-section {
                margin-bottom: 30px;
            }
        
            .form-card {
                background: var(--card-bg);
                padding: 25px;
                border-radius: 10px;
                box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            }
        
            .modern-form {
                display: grid;
                gap: 15px;
            }
        
            .form-group label {
                font-weight: 600;
                color: #2d3748;
                margin-bottom: 5px;
                display: block;
            }
        
            .form-input, .form-select, .form-textarea {
                width: 100%;
                padding: 10px;
                border: 2px solid #e2e8f0;
                border-radius: 6px;
                font-size: 1rem;
                transition: border-color 0.2s Ascendantly all;
                transition: all 0.3s ease-in-out;
            }
        
            .form-input:focus, .form-select:focus, .form-textarea:focus {
                border-color: var(--primary);
                outline: none;
            }
        
            .btn-primary {
                background: var(--primary);
                color: white;
                padding: 12px 20px;
                border: none;
                border-radius: 6px;
                cursor: pointer;
                font-weight: 600;
                transition: background 0.2s;
            }
        
            .btn-primary:hover {
                background: #2b6cb0;
            }
        
            .modal {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                align-items: center;
                justify-content: center;
                z-index: 1050; /* Ensure it appears above other content */
            }
        
            .modal-content {
                background: white;
                padding: 30px;
                border-radius: 10px;
                max-width: 500px;
                width: 90%;
                position: relative;
            }
        
            .modal-close {
                position: absolute;
                top: 10px;
                right: 15px;
                font-size: 1.5rem;
                cursor: pointer;
                color: #718096;
            }
        
            @media (max-width: 768px) {
                .header-title { font-size: 2rem; }
                .quick-action-card { padding: 15px; }
                .form-card { padding: 20px; }
            }
        </style>
        
        <script src="https://kit.fontawesome.com/your-fontawesome-kit.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
        
        <script>
            // Toggle sections
            document.getElementById('resendTrigger').addEventListener('click', () => {
                document.getElementById('resendSection').style.display = 'block';
                document.getElementById('messageSection').style.display = 'none';
            });
        
            document.getElementById('messageTrigger').addEventListener('click', () => {
                document.getElementById('messageSection').style.display = 'block';
                document.getElementById('resendSection').style.display = 'none';
            });
        
            // Reminder Form Logic
            const reminderForm = document.getElementById('reminderForm');
            const reminderOption = document.getElementById('reminderOption');
            const tenantDropdown = document.getElementById('tenantDropdown');
        
            reminderOption.addEventListener('change', () => {
                tenantDropdown.style.display = reminderOption.value === 'single' ? 'block' : 'none';
                if (reminderOption.value === 'single') loadTenants();
            });
        
            async function loadTenants() {
                try {
                    const response = await fetch('/api/tenants');
                    if (!response.ok) throw new Error('Network error');
                    const tenants = await response.json();
                    document.getElementById('tenantId').innerHTML = tenants
                        .map(t => `<option value="${t.id}">${t.name} (${t.email})</option>`)
                        .join('');
                } catch (error) {
                    document.getElementById('tenantId').innerHTML = '<option value="" disabled>Error loading tenants</option>';
                }
            }
        
            // Manual Send Form
            document.getElementById('manualSendAllForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const data = Object.fromEntries(new FormData(e.target));
                try {
                    const response = await fetch('/manual-send-all', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                    const result = await response.json();
                    alert(response.ok ? 'Message sent successfully!' : `Error: ${result.error}`);
                } catch (error) {
                    alert('Network error occurred. Please try again.');
                }
            });
        
            // Resend Reminders Form
            reminderForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const reminderOption = document.getElementById('reminderOption').value;
                const tenantId = document.getElementById('tenantId').value;
                const data = { reminderOption };
                if (reminderOption === 'single') data.tenantId = tenantId;
        
                try {
                    const response = await fetch('/reminders/resend', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                    const result = await response.json();
                    alert(response.ok ? 'Reminders resent successfully!' : `Error: ${result.error}`);
                } catch (error) {
                    alert('Network error occurred. Please try again.');
                }
            });

        
            // Modal Controls
            function showModal(modalId) {
                document.getElementById(modalId).style.display = 'flex';
            }
        
            function closeModal(modalId) {
                document.getElementById(modalId).style.display = 'none';
            }
        </script>
    <!-- REQUIRED SCRIPTS -->
    <!-- jQuery -->
    <script src="/plugins/jquery/jquery.min.js"></script>
    <!-- Bootstrap -->
    <script src="/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- overlayScrollbars -->
    <script src="/plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>
    <!-- AdminLTE App -->
    <script src="/dist/js/adminlte2167.js?v=3.2.0"></script>
  
    <!-- PAGE PLUGINS -->
    <!-- jQuery Mapael -->
    <script src="/plugins/jquery-mousewheel/jquery.mousewheel.js"></script>
    <script src="/plugins/raphael/raphael.min.js"></script>
    <script src="/plugins/jquery-mapael/jquery.mapael.min.js"></script>
    <script src="/plugins/jquery-mapael/maps/usa_states.min.js"></script>
    <!-- ChartJS -->
    <script src="/plugins/chart.js/Chart.min.js"></script>
  
    <!-- AdminLTE for demo purposes -->
    <script src="/dist/js/demo.js"></script>
    <!-- AdminLTE dashboard demo (This is only for demo purposes) -->
    <script src="/dist/js/pages/dashboard2.js"></script>
  </body>
  
  <!-- Mirrored from adminlte.io/themes/v3/index2.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 29 Nov 2024 09:27:35 GMT -->
  
  </html>